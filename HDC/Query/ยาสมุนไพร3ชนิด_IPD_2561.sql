SELECT CASE WHEN d.DIDSTD = '410000000479150020111376' THEN 'ฟ้าทะลายโจร' 
				WHEN d.DIDSTD = '410000000109150020111376' THEN 'ขมิ้นชันแคปซูล'
				WHEN d.DIDSTD = '420000005300000020311376' THEN 'ยาเหลืองปิดสมุทร'  END as 'Herb'
			,	d.DIDSTD
			, SUM(CASE WHEN d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376') THEN ci.COST	ELSE 0 END) AS 'COST'
			, SUM(CASE WHEN d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376') THEN ci.PRICE	ELSE 0 END) AS 'PRICE'
			, SUM(CASE WHEN d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376') THEN ci.PAYPRICE	ELSE 0 END) AS 'PAYPRICE'
			
FROM charge_ipd as ci 
	LEFT JOIN admission as a ON ci.hospcode = a.hospcode AND ci.pid = a.pid AND ci.an = a.an AND ci.DATETIME_ADMIT = a.DATETIME_ADMIT
	LEFT JOIN drug_ipd as d ON ci.hospcode = d.hospcode AND ci.pid = d.PID AND a.PID = d.PID AND d.DATETIME_ADMIT = ci.DATETIME_ADMIT AND d.DATETIME_ADMIT = a.DATETIME_ADMIT

WHERE ci.DATETIME_ADMIT BETWEEN '2017-10-01' AND '2018-09-30'
	AND d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376')
	
GROUP BY d.DIDSTD