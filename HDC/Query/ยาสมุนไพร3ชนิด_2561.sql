SELECT 	d.DIDSTD
			, CASE WHEN d.DIDSTD = '410000000479150020111376' THEN 'ฟ้าทะลายโจร' 
				WHEN d.DIDSTD = '410000000109150020111376' THEN 'ขมิ้นชันแคปซูล'
				WHEN d.DIDSTD = '420000005300000020311376' THEN 'ยาเหลืองปิดสมุทร'  END as 'Herb'
			, SUM(CASE WHEN d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376') THEN co.COST	ELSE 0 END) AS 'COST'
			, SUM(CASE WHEN d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376') THEN co.PRICE	ELSE 0 END) AS 'PRICE'
			, SUM(CASE WHEN d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376') THEN co.PAYPRICE	ELSE 0 END) AS 'PAYPRICE'
			


FROM charge_opd as co 
	LEFT JOIN service as s ON co.hospcode = s.hospcode
		AND co.pid = s.pid AND co.SEQ = s.SEQ AND co.date_serv = s.date_serv
	LEFT JOIN drug_opd as d ON co.hospcode = d.hospcode AND co.pid = d.PID AND co.seq = d.seq AND co.date_serv = d.date_serv
		AND s.hospcode = d.hospcode AND s.pid = d.pid and s.seq = d.seq and s.date_serv = d.date_serv

WHERE co.date_serv BETWEEN '2017-10-01' AND '2018-09-30'
	AND d.DIDSTD IN ('420000005300000020311376','410000000109150020111376','410000000479150020111376')
	
GROUP BY d.DIDSTD